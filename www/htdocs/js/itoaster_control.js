var itoaster={listGATagSetting:{executable:!1,category:null,action:null},init:function(e){this.viewController="sp"==e?recommendViewControllerSp:recommendViewControllerPc},viewController:null,onInitListAsync:function(){},setListGATag:function(e,t){this.listGATagSetting.executable=!0,this.listGATagSetting.category=e,this.listGATagSetting.action=t},getPageType:function(){return-1!==vp.originUrl.indexOf("detail.htm")?"DTL":(-1!==vp.originUrl.indexOf("list.htm")||-1!==vp.originUrl.indexOf("city.htm")||-1!==vp.originUrl.indexOf("groupcity.htm")||-1!==vp.originUrl.indexOf("shokusyu.htm")||-1!==vp.originUrl.indexOf("koyo.htm")||-1!==vp.originUrl.indexOf("style.htm")||-1!==vp.originUrl.indexOf("rail.htm")||-1!==vp.originUrl.indexOf("sta.htm")||-1!==vp.originUrl.indexOf("cl.htm")||-1!==vp.originUrl.indexOf("cls.htm")||-1!==vp.originUrl.indexOf("new.htm")||-1!==vp.originUrl.indexOf("fw.htm")||-1!==vp.originUrl.indexOf("closelist.htm"))&&"LST"},recommendnowAsync:function(){var e=this,t=new jQuery.Deferred;return null==vp.originUrl?t.reject():"DTL"==this.getPageType()?(this._initDetailAsync().done(function(){console.log("type:recommend"),t.resolve()}).fail(function(){console.log("type:fail_recommend"),t.reject()}),this.setId()):"LST"==this.getPageType()?this._initListAsync().done(function(){e.onInitListAsync(),console.log("type:recommend"),t.resolve()}).fail(function(){console.log("type:fail_recommend"),t.reject()}):(console.log("type:no_recommend"),t.reject()),t.promise()},_initListAsync:function(){var t=this,i=new jQuery.Deferred;return this.getUserRecAsync("apssp").then(function(e){if(!e.length)return t.getItemRecFromBrowsingHistoryAsync("apssp");t.viewController.createListRecommend(e),i.resolve()},function(){return t.getItemRecFromBrowsingHistoryAsync("apssp")}).then(function(e){e?e.length?(t.viewController.createListRecommend(e),i.resolve()):i.reject():i.resolve()},function(){i.reject()}),i.promise()},_initDetailAsync:function(){var t=this,i=new jQuery.Deferred,e=vp.originUrl.match(/(A[0-9]{11}|B[0-9]{11})/)[1];return this.getItemRecAsync(e,"apssp").done(function(e){e.length?(t.viewController.createDetailRecommend(e),i.resolve()):i.reject()}).fail(function(){i.reject()}),i.promise()},setId:function(){var e,t=vp.originUrl.match(/rectype=(d|l)/),i=vp.originUrl.match(/(A[0-9]{11}|B[0-9]{11})/);null!==t&&null!==i&&("l"===t[1]?e=jQuery.cookie("recdtll"):"d"===t[1]&&(e=jQuery.cookie("recdtld")),void 0===e?e=i[1]:e+=":"+i[1],"l"===t[1]?jQuery.cookie("recdtll",e):"d"===t[1]&&jQuery.cookie("recdtld",e))},getLastBrowsingJobAsync:function(){var t=new jQuery.Deferred;return $.ajax({type:"GET",url:"/aps/api/browsinghistory/list",contentType:"application/json",dataType:"json"}).done(function(e){e.results.length?t.resolve(e.results[0]):t.reject()}).fail(function(){t.reject()}),t.promise()},getItemRecFromBrowsingHistoryAsync:function(t,i){var n=this,r=new jQuery.Deferred;return this.getLastBrowsingJobAsync().done(function(e){n.getItemRecAsync(e.job_id,t,i).done(function(e){r.resolve(e)}).fail(function(){r.reject()})}).fail(function(){r.reject()}),r.promise()},getUserRecAsync:function(e,t){void 0===t&&(t=10);var i=new $.Deferred;return jQuery.ajax({type:"GET",dataType:"json",url:"/aps/api/recommend/user/job/list?noi="+t+"&media_type="+e}).done(function(e){i.resolve(e)}).fail(function(){i.reject()}),i.promise()},getItemRecAsync:function(e,t,i){void 0===i&&(i=10);var n=new $.Deferred;return jQuery.ajax({type:"GET",dataType:"json",url:"/aps/api/recommend/item/job/list?id="+e+"&noi="+i+"&media_type="+t}).done(function(e){n.resolve(e)}).fail(function(){n.reject()}),n.promise()}},recommendViewControllerSp={headding:"<h3><span>あなたの希望条件に近い求人情報</span></h3>",getRecommendListItemForList:function(e,t){null==vp.ac&&(vp.ac="00");var i=$('<li style="display: table;"><img src=""><a href=""><span class="occupation"></span><br><span class="pay"></span><br><span class="place"></span></a></li>');i.find("a").attr("href","/aps/"+vp.ac+"_"+e.job_offer_id+"_detail.htm?rectype="+t),itoaster.listGATagSetting.executable&&i.find("a").attr("onclick","ga('send', 'event', '"+itoaster.listGATagSetting.category+"', '"+itoaster.listGATagSetting.action+"', '"+e.job_offer_id+"');");var n=e.img01_http_url.replace("http://","https://");return""==n&&(n="/aps/assets/pc/img/common/noimg.jpg"),i.find("img").addClass("lazy user_recommend_img").attr({src:"/aps/assets/shared/img/naught.jpg","data-original":n}),i.find(".occupation").text(e.VAL02),i.find(".pay").text(e.kyuuyo_txt),i.find(".place").text(e.kinmuchi_txt),i},getRecommendListItemForDetail:function(e,t){null==vp.ac&&(vp.ac="00");var i=$('<li><div id="" class="jobid"><a href="" class="jobdetail"><span class="occupation"></span><br><span class="pay"></span><br><span class="place"></span><br><span class="employment"></span></a><div class="recommendDetailBtn"><a href="">詳細を見る</a></div><div class="keepBtn"><a href="javascript:void(0);" onclick="">とりあえずキープ</a></div><div class="keepzumiBtn"><a href="javascript:void(0);" onclick="">キープ中</a></div></div></li>'),n="/aps/"+vp.ac+"_"+e.job_offer_id+"_detail.htm?rectype="+t;if(i.find("a").attr("href",n),tmp_str=e.VAL02,30<tmp_str.length&&(tmp_str=tmp_str.substring(0,30)+"…"),i.find(".occupation").text(tmp_str).prepend('<span class="title">【職種】</span>'),""!=e.kyuuyo_txt)i.find(".pay").text(e.kyuuyo_txt).prepend('<span class="title">【給与】</span>');else{var r=i.find("a").html();r=r.replace('<span class="pay"></span><br>',""),i.find("a.jobdetail").html(r)}return i.find(".place").text(e.kinmuchi_txt).prepend('<span class="title">【勤務地】</span>'),i.find(".employment").text(e.koyo_txt).prepend('<span class="title">【雇用形態】</span>'),i.find(".jobid").attr("id",e.job_offer_id),i.find(".recommendDetailBtn a").attr("href",n),i.find(".keepBtn a").attr("onclick","executeKento('"+e.job_offer_id+"'); ga('send', 'event', 'Detail', 'Keep_in', '"+e.job_offer_id+"');").attr("href","javascript:void(0);"),i.find(".keepzumiBtn a").attr("onclick","deleteKento('"+e.job_offer_id+"'); ga('send', 'event', 'Detail', 'Keep_out', '"+e.job_offer_id+"');").attr("href","javascript:void(0);"),i},createListRecommend:function(e){var i=this,n=$('<ul id="rcmnd"></ul>');$(e).each(function(e,t){n.append(i.getRecommendListItemForList(t,"l"))}),$("#recommend_list").html(n),$("#rcmnd").before(this.headding)},createDetailRecommend:function(e){var i=this,n=$('<ul id="rcmnd_b"></ul>');$(e).each(function(e,t){n.append(i.getRecommendListItemForDetail(t,"d"))}),$("#recommend_list").html(n),$("#rcmnd_b").before(this.headding)}},recommendViewControllerPc={getRecommendListItem:function(e,t){null==vp.ac&&(vp.ac="00");var i=$('<li><dl><dd class="imgBox autoresizebase"><a href=""><div><img src="" class="lazy" alt="pic"></div></a></dd><dd class="name occupation"><a href=""></a></dd><dd class="name pay"></dd><dd class="name place"></dd><dd class="btn"><a href="">詳細はこちらから</a></dd></dl></li>');return i.find("a").attr("href","/aps/"+vp.ac+"_"+e.job_offer_id+"_detail.htm?rectype="+t+"&recid=02"),""==e.img01_http_url&&(e.img01_http_url="/aps/assets/pc/img/common/noimg.jpg"),i.find(".imgBox img").attr("src",e.img01_http_url),i.find(".occupation a").text(e.VAL02),i.find(".pay").text(e.kyuuyo_txt),i.find(".place").text(e.kinmuchi_txt),i},createListRecommend:function(e){var i=this,n=$('<ul id="rtpc_listright_user" style="display: block;"></ul>');$(e).each(function(e,t){n.append(i.getRecommendListItem(t,"l"))}),$("#rtoasterRightList").html(n).show()},createDetailRecommend:function(e){var i=this,n=$('<ul id="rtpc_detailright_item" style="display: block;"></ul>');$(e).each(function(e,t){n.append(i.getRecommendListItem(t,"d"))}),$("#rtoasterRightList").html(n),$("#contents").css({margin:"0px",float:"left"}),$("#rtoasterRightList").css({display:"block",margin:"35px 0px"}).show()}};